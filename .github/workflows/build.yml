- name: Install Flutter and Build
        run: |
          # 1. 打印当前目录结构，方便我们排错（在日志里能看到）
          echo "Current directory listing:"
          ls -R | grep ":$" | sed -e 's/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /'
          
          # 2. 尝试寻找 pubspec.yaml 所在的绝对路径
          CONF_PATH=$(find . -name pubspec.yaml -printf '%h\n' | head -n 1)
          echo "Found project at: $CONF_PATH"
          
          if [ -z "$CONF_PATH" ]; then
            echo "Error: Could not find pubspec.yaml anywhere!"
            exit 1
          fi
          
          cd "$CONF_PATH"
          
          # 3. 执行编译
          flutter pub get
          cd android
          chmod +x gradlew
          ./gradlew assembleDefaultRelease
